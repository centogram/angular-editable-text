!function(){"use strict";angular.module("gg.editableText",["puElasticInput"])}(),function(){"use strict";function a(a,b,c){function d(c,d,e){function f(a,f){var j=h[0];e.hasOwnProperty("ggEditMode")||(c.editMode=a),d[a?"addClass":"removeClass"]("editing"),a?(j.focus(),i||(j.selectionStart=j.selectionEnd=c.editingValue?c.editingValue.length:0),i=!1,e.hasOwnProperty("ggSelectAll")&&j.select()):e.hasOwnProperty("ggOnChange")&&a!==f&&c.editingValue!==g?(c.isWorking=!0,b.when(c.onChange({value:c.editingValue})).then(function(a){"undefined"!=typeof a&&(c.editingText=c.editingValue=a)},function(){c.editingValue=c.editableText})["finally"](function(){c.isWorking=!1})):c.editableText=c.editingValue}var g,h=d.find("input"),i=!1;c.$watch("isEditing",f),c.$watch("editMode",function(a){c.isEditing=!!a}),c.$watch("editableText",function(a){g=a,c.editingValue=a}),c.isEditing=!!c.editMode,c.editingValue=c.editableText,d.addClass("gg-editable-text"),c.onInputFocus=function(){c.isEditing=!0,i=!0},c.onInputBlur=function(){c.isEditing=!1,a.$evalAsync(function(){$(h[0]).width($(d).width())})},c.onKeyPress=function(a){var b=h[0];13===a.which?e.hasOwnProperty("ggKeepFocus")?(c.onInputBlur(),f(!1),f(!0)):$(b).blur():27===a.which&&(c.editingValue=c.editableText,$(b).blur())}}return{restrict:"EA",scope:{editableText:"=ggEditableText",editMode:"=ggIsEditing",placeholder:"@",onChange:"&ggOnChange"},transclude:!0,template:'<span ng-class="{\'is-placeholder\': placeholder && !editingValue}" ng-style="{\'max-width\': \'inherit\'}" ><input ng-focus="onInputFocus()" ng-click="onInputFocus()" ng-blur="onInputBlur()" ng-keydown="onKeyPress($event)" ng-model="editingValue" placeholder="{{placeholder}}" type="text" pu-elastic-input pu-elastic-input-minwidth="auto" pu-elastic-input-maxwidth="inherit" /><span ng-hide="isEditing" ng-transclude></span><span ng-show="isWorking && EditableTextHelper.workingText.length" class="'+c.workingClassName+'">'+c.workingText+"</span></span>",link:d}}angular.module("gg.editableText").directive("ggEditableText",a),a.$inject=["$rootScope","$q","EditableTextHelper"]}(),function(){"use strict";function a(){var a="",b="";this.setWorkingText=function(b){return a=b,this},this.setWorkingClassName=function(a){return b=a,this},this.$get=function(){return{workingText:a,workingClassName:b}}}angular.module("gg.editableText").provider("EditableTextHelper",a)}();